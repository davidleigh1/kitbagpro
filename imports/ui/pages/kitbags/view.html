<template name="kitbagView">

<!--
Examples:
https://elgg.item/plugins/350857/icons/1899256.jpg
http://vendroid.venmond.com/img/screenshot/vendroid-09.jpg
http://bootstrap.snipplicious.com/snippets/preview/19?name=edit-profile-page
 -->

{{#if Template.subscriptionsReady}}

<div class="screen-wrapper objAddEdit kitbagView">
		<!-- Page Heading -->
	<!--{{> pageHeader
			pageTitle = getTitle
			pageSubtitle = ""
			faIcon = getIcon
			}} -->

	{{#with thisKitbag}}
	<div class="row">

		<div class="col-lg-12">
			<div class="panel panel-default">
				<div class="panel-heading">
					<h3 class="">
						{{>kitbagLogo}}
						{{kitbagTitle}}
						<small>{{pageSubtitle}}</small>
					</h3>
				</div>
				<div class="panel-body">

					<!-- Control Panel -->
					<div class="row">
						<div class="col-lg-12 tableControlPanel">
							<!-- Control Buttons -->
							<!-- fa-fw  makes the icons 'fixed width' -->
							<a href="./edit" class="btn btn-primary">
								<i class="fa fa-fw fa-edit"></i> Edit Kitbag
							</a>
							<a href="./edit#kitbagAssocKitbags" class="btn btn-primary">
								<i class="fa fa-fw fa-medkit"></i> Assign to Kitbag
							</a>
							<a href="/kitbags/duplicate/{{kitbagId}}" class="btn btn-primary">
								<i class="fa fa-fw fa-files-o"></i> Duplicate
							</a>
							{{#if glb_userIsSuperAdmin}}
								<a href="#" class="btn btn-danger delete">
									<i class="fa fa-fw fa-exclamation-triangle"></i> Delete
								</a>
							{{/if}}
							{{#if glb_userIsOrgAdmin}}
								<a href="#" class="btn btn-label-default trash {{#if isTrashed}}disabled{{/if}}">
									<i class="fa fa-fw fa-trash"></i> Trash
								</a>
							{{/if}}
							<a href="/dashboard" class="btn btn-info">
								<i class="fa fa-fw fa-dashboard"></i> Analytics
							</a>
							<a href="#kitbagKitbagListPanel" class="btn btn-info">
								<i class="fa fa-fw fa-medkit"></i> Kitbag List
							</a>
							<a href="/users/list?kitbag=thisKitbagId" class="btn btn-info">
								<i class="fa fa-fw fa-users"></i> View Inventory
							</a>
						</div>
					</div>

					<!-- <h2>Bordered with Striped Rows</h2> -->
					<!--{{#if kitbagDesc}}
						<div class="well">
							{{kitbagDesc}}
						</div>
					{{/if}} -->
					<div class="table-responsive">
						<table class="table table-hover table-condensed">

							<tbody>

								<tr>
									<th colspan="2" class="table-divider">Kitbag Details</th>
								</tr>

								{{#if glb_userIsSuperAdmin}}
									<tr class="adminOnly">
										<th>Organisation</th>
										<td>
											{{#if kitbagAssocOrg}}
												<span title="{{kitbagAssocOrg}}">{{lookupFieldFromOrg kitbagAssocOrg 'orgTitle'}} ({{kitbagAssocOrg}})</span>
											{{else}}
												Organisation not found
											{{/if}}
										</td>
									</tr>
								{{/if}}


								<tr>
									<th class="col-xs-2">Kitbag</th>
									<td class="col-xs-10"><strong>{{kitbagTitle}}</strong></td>
								</tr>
								<tr>
									<th>Detail</th>
									<td>{{kitbagDetail}}</td>
								</tr>
								<tr>
									<th>Status</th>
									<td><span class="label {{gKitbagStatusTag.labelClass}}">{{gKitbagStatusTag.labelText}}</span></td>
								</tr>
								<tr>
									<th>Description</th>
									<td>{{kitbagDesc}}</td>
								</tr>
								<tr>
									<th>Age Group</th>
									<td>{{patientAgeGroup}}</td>
								</tr>
								<tr>
									<th>Size</th>
									<td>{{kitbagSize}}</td>
								</tr>

								<tr>
									<th colspan="2" class="table-divider">Inventory Management</th>
								</tr>

								<tr>
									<th>Kitbags with this Kitbag</th>
									<td>{{kitbagAssocKitbagCount}}</td>
								</tr>

								<tr>
									<th>List of Kitbags</th>
									<td>
										{{assocKitbags}}
										<!--
 										{{#each assocKitbags}}
											{{#with thisKitbag kitbagId}}
												<a href="/kitbags/{{kitbagId}}/view">
													{{lookupFieldFromKb kitbagId 'kitbagTitle'}}
												</a>
												<span class="label {{gKitbagStatusTag.labelClass}} pull-right">
													{{gKitbagStatusTag.labelText }}
												</span>
												<small><span class="text-muted kitbagIdCol">
													{{kitbagId}}{{assignedBag}}
												</span></small>
												<br>
											{{/with}}
										{{/each}}
										-->
									</td>
								</tr>
								<tr>
									<th>Is Mandatory for Service</th>
									<td>{{#if kitbagIsMandatory}}<i class="fa fa-check text-muted" aria-hidden="true"></i>{{else}}<i class="fa fa-times text-muted" aria-hidden="true"></i>{{/if}}</td>
								</tr>
								<tr>
									<th>Min Quantity (Qmin)</th>
									<td>{{kitbagQMin}}</td>
								</tr>
								<tr>
									<th>Recommended (Qrec)</th>
									<td>{{kitbagQRecommended}}</td>
								</tr>
								<tr>
									<th>Max Quantity (Qmax)</th>
									<td>{{kitbagQMax}}</td>
								</tr>


								<tr>
									<th colspan="2" class="table-divider">Manufacturer Details</th>
								</tr>

								<tr>
									<th>Brand</th>
									<td>{{kitbagManufacturer}}</td>
								</tr>
								<tr>
									<th>Model</th>
									<td>{{kitbagModel}}</td>
								</tr>
								<tr>
									<th>Org SKU</th>
									<td>{{kitbagSku}}</td>
								</tr>
								<tr>
									<th>MfrPart #</th>
									<td>{{kitbagPartNumber}}</td>
								</tr>
								<tr>
									<th>EAN/UPC</th>
									<td>{{kitbagEanUpc}}</td>
								</tr>

								<tr>
									<th colspan="2" class="table-divider">Advanced Details</th>
								</tr>

								<tr>
									<th>URL</th>
									<td><a href="{{kitbagUrl}}" target="_blank">{{kitbagUrl}}</a></td>
								</tr>
								<tr>
									<th>Profile Photo</th>
									<td class="hover_img">

										{{>urlImagePreviewRollover
											imageUrl = kitbagImgLarge
											imagePreviewText = (joinTextInList "Photo of '<b>" kitbagTitle "</b>'. Click to open in a new tab." )
											imageAltText = (joinTextInList "Photo of '" kitbagTitle "'. Click or mouseover to view." )
											imagePreviewHeight = "50%"
										}}

									</td>
								</tr>
								<tr>
									<th>Profile Icon</th>
									<td class="hover_img">

										{{>urlImagePreviewRollover
											imageUrl = kitbagImgSmall
											imagePreviewText = (joinTextInList "Icon preview for '<b>" kitbagTitle "</b>'. Click to open in a new tab." )
											imageAltText = (joinTextInList "Icon image for '" kitbagTitle "'. Click or mouseover to view." )
											imagePreviewHeight = "20%"
										}}

									</td>
								</tr>
							<!-- start -->
							</tbody>
						</table>
					<!-- /table-responsive -->
					</div>

					<!-- /panel-body -->
				</div>
				<!-- /panel-default -->
			</div>
			<!-- /col-12 -->
		</div>


		<!-- KITBAGS MINILIST (listing 'assocKitbags') -->
		<div class="col-lg-12">
			<div class="panel panel-default" id="kitbagKitbagListPanel">
				<div class="panel-heading">
					<h3 class="panel-title"><i class="fa fa-fw fa-medkit"></i> Kitbags Containing This Kitbag ({{get_kitbagBagsFound}})</h3>
				</div>
				<div class="panel-body">
					<!-- <h2>Bordered with Striped Rows</h2> -->

					<div class="table-responsive">
						<table class="table table-bordered-XXX table-hover table-striped-XXX table-condensed">
							<thead>
								<tr>
									<th class="hidden-xs">Kitbag</th>
									{{#if glb_userIsSuperAdmin}}
										<th class="hidden-xs adminOnly">Org</th>
									{{/if}}
									<th class="hidden-xs">Status</th>
									<th class="hidden-xs text-center todo">Kitbags</th>
									<th class="hidden-xs text-center todo">Users</th>
									<th class="hidden-xs hidden-sm">Bag ID</th>
									<th class="visible-lg">Created</th>
									<th class="hidden-xs hidden-sm hidden-md">Owner</th>
									<th class="text-right">Actions</th>
								</tr>
							</thead>
							<tbody>

								<!-- Show 'Loading...' if not ready -->
								{{#if Template.subscriptionsReady}}
									<!-- Show 'noListObjectsFound' template if none found -->
									{{#if objectsFiltered "kitbagsContainingThisKitbag" noFilter minilistFilter}}
										<!-- Select subset of kitbag docs based on user/template filters-->
										{{#each objectsFiltered "kitbagsContainingThisKitbag" noFilter minilistFilter}}
											{{ >kitbagLine thisKitbag=this listType="kitbagView" }}
										{{/each}}
									{{else}}
										{{ >noListObjectsFound objectName="kitbags containing this kitbag were" }}
									{{/if}}
								{{else}}
									loading...
								{{/if}}

							</tbody>
						</table>
					</div>

				<!-- /panel-body -->
				</div>
			<!-- /panel-default -->
			</div>
		<!-- /col-12 -->
		</div>


		<div class="col-lg-12">
			<div class="panel panel-info" id="systemInfo">
				<div class="panel-heading">
					<h3 class="panel-title"><i class="fa fa-fw fa-database"></i> System Info</h3>
				</div>
				<div class="panel-body">
					<!-- <h2>Bordered with Striped Rows</h2> -->
					<div class="table-responsive">
						<table class="table table-hover table-condensed">
							<!-- <thead>
								<tr>
									<th>Page</th>
									<th>Visits</th>
									<th>% New Visits</th>
									<th>Revenue</th>
								</tr>
							</thead> -->
							<tbody>
								<!-- end -->
								<tr>
									<th>External ID</th>
									<td><code>{{kitbagId}}</code></td>
								</tr>
								<tr>
									<th>Internal ID</th>
									<td>{{_id}}</td>
								</tr>
								<tr>
									<th>Created</th>
									<td>{{createdAt}} by {{#if createdBy}}<code>{{createdBy}}</code>{{else}}Unknown{{/if}}</td>
								</tr>
								<tr>
									<th>Last Updated</th>
									<td>{{updatedAt}} by {{#if updatedBy}}<code>{{updatedBy}}</code>{{else}}Unknown{{/if}}</td>
								</tr>
								<tr>
									<th>Created Via</th>
									<td>{{#if createdVia}}<code>{{createdVia}}</code>{{else}}Unknown{{/if}}</td>
								</tr>
								<!-- <tr>
									<th>Owner</th>
									<td>
									{{#if userNameLookup owner "html"}}
										{{userNameLookup owner "html"}} (api_id: <code>{{userNameLookup owner "apiId"}}</code> / db_id: {{owner}})
									{{else}}
										{{owner}}<span class="subtitle">(User details not found)</span>
									{{/if}}
									</td>
								</tr> -->
								<tr>
									<th>Account Data</th>
									<td>Associated Kitbags => array of Kitbag IDs&#10;Active Users => array of User IDs&#10;Inactive Users => array of User IDs&#10;Deleted Users => array of User ID</td>
								</tr>
							</tbody>
						</table>
					<!-- /table-responsive -->
					</div>
				<!-- /panel-body -->
				</div>
			<!-- /panel-default -->
			</div>
		<!-- /col-12 -->
		</div>
	<!-- /row -->
	</div>
	{{/with}}

<!--
	<div class="row">
		<form id="add-edit-kitbag" class="add-edit-kitbag">
			<div class="formline">
				<label for="kitbagId">Kitbag ID:</label>
				<input type="text" id="kitbagId" name="kitbagId" data-submit="true" placeholder="ID is generated on submission" disabled="disabled">
			</div>
			<div class="formline">
				<label for="kitbagStatus">Status:</label>
				<select class="statusSelectList" name="kitbagStatus" data-submit="true">
					{{#each listKitbagStatuses}}
						<option value="{{this}}">{{this}}</option>
					{{/each}}
				</select>
			</div>




			<div class="formline">
				<label for="kitbagTitle">Name:</label>
				<input type="text" name="kitbagTitle" data-submit="true" placeholder="Kitbag Name">
			</div>
			<div class="formline">
				<label for="kitbagDesc">Description:<span class="subtitle">(max 400 chars)</span></label>
				<input type="text" name="kitbagDesc" data-submit="true" placeholder="Brief summary of Kitbag and its goals">
			</div>
			<div class="formline">
				<label for="kitbagUrl">Website:</label>
				<input type="url" name="kitbagUrl" data-submit="true" placeholder="Website/homepage URL" value="">
			</div>
			<div class="formline">
				<label for="kitbagContactPerson">Contact Person:</label>
				<input type="text" name="kitbagContactPerson" data-submit="true" placeholder="Name of contact person">
			</div>
			<div class="formline">
				<label for="kitbagContactPhone">Contact Phone:</label>
				<input type="text" name="kitbagContactPhone" data-submit="true" placeholder="Contact phone number">
			</div>
			<div class="formline">
				<label for="kitbagContactEmail">Contact Email:</label>
				<input type="email" name="kitbagContactEmail" data-submit="true" placeholder="Contact email address">
			</div>
			<div class="formline">
				<label for="kitbagImgLarge">Profile Photo:<span class="subtitle">(max 512x512)</span></label>
				<input type="url" name="kitbagImgLarge" data-submit="true" placeholder="URL for larger kitbaganization logo (max 512x512 / *.jpg or *.png)">
			</div>
			<div class="formline">
				<label for="kitbagImgSmall">Profile Icon:<span class="subtitle">(max 32x32)</span></label>
				<input type="url" name="kitbagImgSmall" data-submit="true" placeholder="URL for smaller kitbaganization logo icon (max 32x32 / *.jpg or *.png)">
			</div>
			<div class="formline">
				<label for="createdAt">Created:</label>
				<input type="text" id="createdAt" name="createdAt" data-submit="true" placeholder="Timestamp will be generated on submission" disabled="disabled">
			</div>
			<div class="formline">
				<label for="updatedAt">Last Updated:</label>
				<input type="text" id="updatedAt" name="updatedAt" data-submit="true" placeholder="Timestamp will be generated on submission" disabled="disabled">
			</div>
			<div class="formline">
				<label for="owner">Owner:</label>
				<input type="text" id="owner" name="owner" data-submit="true" placeholder="Your User ID will be recorded on submission" disabled="disabled" value="{{nameFromOwner}}">
			</div>
			<div class="formline">
				<label for="account_data">Account Data:</label>
				<textarea>Associated Kitbags => array of Kitbag IDs&#10;Active Users => array of User IDs&#10;Inactive Users => array of User IDs&#10;Deleted Users => array of User ID</textarea>
			</div>

			<input type="hidden" name="kitbagAssocKitbags" data-type="array" data-submit="true">

			<button class="submit">Submit</button>
			<button class="cancel">Cancel</button>
		</form>
	</div>
-->



	<!-- Initialize -->
	<!-- {{initialize}} -->

</div>
<!-- /screen-wrapper -->


{{else}}
	{{>loading}}
{{/if}}

</template>